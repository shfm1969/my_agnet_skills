# Security Scan Report

**Project**: {{PROJECT_NAME}}
**Scan Date**: {{SCAN_DATE}}
**Scan Type**: {{SCAN_TYPE}}

---

## Executive Summary

| Severity | Count |
|----------|-------|
| Critical | {{CRITICAL_COUNT}} |
| High | {{HIGH_COUNT}} |
| Medium | {{MEDIUM_COUNT}} |
| Low | {{LOW_COUNT}} |
| Info | {{INFO_COUNT}} |

**Overall Risk Level**: {{RISK_LEVEL}}

---

## Scan Coverage

### Files Scanned
- Total files: {{TOTAL_FILES}}
- Source files (.ts/.tsx/.js/.jsx): {{SOURCE_FILES}}
- Configuration files: {{CONFIG_FILES}}

### Checks Performed
- [x] Dependency audit (CVE check)
- [x] Secret/credential scanning
- [x] XSS vulnerability patterns
- [x] Injection vulnerability patterns
- [x] Authentication/authorization patterns
- [x] Next.js specific vulnerabilities
- [x] Security header configuration
- [x] Environment variable exposure

---

## Critical Findings

{{#CRITICAL_FINDINGS}}
### {{INDEX}}. {{TITLE}}

**Severity**: CRITICAL
**Category**: {{CATEGORY}}
**File**: `{{FILE}}:{{LINE}}`

**Vulnerable Code**:
```{{LANGUAGE}}
{{CODE}}
```

**Risk**: {{DESCRIPTION}}

**Recommendation**: {{RECOMMENDATION}}

---
{{/CRITICAL_FINDINGS}}

## High Severity Findings

{{#HIGH_FINDINGS}}
### {{INDEX}}. {{TITLE}}

**Severity**: HIGH
**Category**: {{CATEGORY}}
**File**: `{{FILE}}:{{LINE}}`

**Vulnerable Code**:
```{{LANGUAGE}}
{{CODE}}
```

**Risk**: {{DESCRIPTION}}

**Recommendation**: {{RECOMMENDATION}}

---
{{/HIGH_FINDINGS}}

## Medium Severity Findings

{{#MEDIUM_FINDINGS}}
### {{INDEX}}. {{TITLE}}

**Severity**: MEDIUM
**Category**: {{CATEGORY}}
**File**: `{{FILE}}:{{LINE}}`

**Description**: {{DESCRIPTION}}

**Recommendation**: {{RECOMMENDATION}}

---
{{/MEDIUM_FINDINGS}}

## Low Severity & Informational Findings

{{#LOW_FINDINGS}}
- **{{TITLE}}** (`{{FILE}}:{{LINE}}`): {{DESCRIPTION}}
{{/LOW_FINDINGS}}

---

## Dependency Audit Results

### Vulnerable Dependencies

| Package | Severity | CVE | Installed | Patched |
|---------|----------|-----|-----------|---------|
{{#VULNERABLE_DEPS}}
| {{PACKAGE}} | {{SEVERITY}} | {{CVE}} | {{INSTALLED}} | {{PATCHED}} |
{{/VULNERABLE_DEPS}}

### Outdated Dependencies (Security Relevant)

| Package | Current | Latest | Notes |
|---------|---------|--------|-------|
{{#OUTDATED_DEPS}}
| {{PACKAGE}} | {{CURRENT}} | {{LATEST}} | {{NOTES}} |
{{/OUTDATED_DEPS}}

---

## Next.js Specific Checks

### Version Check
- **Installed Version**: {{NEXTJS_VERSION}}
- **Latest Stable**: {{NEXTJS_LATEST}}
- **Known CVEs**: {{NEXTJS_CVES}}

### Configuration Review

| Check | Status | Notes |
|-------|--------|-------|
| Security headers configured | {{HEADERS_STATUS}} | {{HEADERS_NOTES}} |
| Image domains restricted | {{IMAGE_STATUS}} | {{IMAGE_NOTES}} |
| Server Actions protected | {{ACTIONS_STATUS}} | {{ACTIONS_NOTES}} |
| Environment variables secure | {{ENV_STATUS}} | {{ENV_NOTES}} |

---

## Recommendations Summary

### Immediate Actions (Critical/High)

1. {{IMMEDIATE_ACTION_1}}
2. {{IMMEDIATE_ACTION_2}}
3. {{IMMEDIATE_ACTION_3}}

### Short-term Improvements (Medium)

1. {{SHORTTERM_ACTION_1}}
2. {{SHORTTERM_ACTION_2}}
3. {{SHORTTERM_ACTION_3}}

### Best Practice Suggestions (Low/Info)

1. {{BESTPRACTICE_1}}
2. {{BESTPRACTICE_2}}
3. {{BESTPRACTICE_3}}

---

## Appendix

### A. OWASP Top 10:2025 Mapping

| Finding | OWASP Category |
|---------|----------------|
{{#OWASP_MAPPING}}
| {{FINDING}} | {{OWASP_CATEGORY}} |
{{/OWASP_MAPPING}}

### B. Tools Used

- Dependency Audit: npm audit / yarn audit
- Secret Scanner: custom pattern matching
- Pattern Scanner: regex-based static analysis
- Reference: OWASP Cheat Sheet Series

### C. Scan Configuration

```json
{
  "scanType": "{{SCAN_TYPE}}",
  "includePaths": {{INCLUDE_PATHS}},
  "excludePaths": {{EXCLUDE_PATHS}},
  "categories": {{CATEGORIES}}
}
```

---

*Report generated by Next.js Security Scan Skill*
*Based on OWASP Top 10:2025 and industry best practices*
